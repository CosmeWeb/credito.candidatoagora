<section class="container">
    <div class="tituloconteudo">
        <h1><?php echo $obj->titulodavaga; ?></h1>
        <svg id="progress-steps" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 705 26">
            <defs>
                <linearGradient id="linear-gradient" x1="1" y1="1" x2="0" y2="1" gradientUnits="objectBoundingBox">
                <stop offset="0" stop-color="#116cdd"/>
                <stop offset="1" stop-color="#116cdd" stop-opacity="0"/>
                </linearGradient>
            </defs>
            <g id="Group_2941" data-name="Group 2941" transform="translate(-670 -106)">
                <g id="progress-steps" transform="translate(670 106)">
                <g id="step3" transform="translate(420.819 -6)">
                    <g id="Ellipse" transform="translate(6.181 6)" fill="#116cdd" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_4" data-name="4" transform="translate(19.181 24)" fill="#fff" stroke="rgba(0,0,0,0)" stroke-miterlimit="10" stroke-width="1" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">4</tspan></text>
                </g>
                <g id="step3-2" data-name="step3" transform="translate(164.819 -6)">
                    <g id="Ellipse-2" data-name="Ellipse" transform="translate(136.181 6)" fill="none" stroke="#a5a4bf" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_3" data-name="3" transform="translate(149.181 24)" fill="#a5a4bf" stroke="rgba(0,0,0,0)" stroke-miterlimit="10" stroke-width="1" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">3</tspan></text>
                </g>
                <g id="step3-3" data-name="step3" transform="translate(503.819 -6)">
                    <g id="Ellipse-3" data-name="Ellipse" transform="translate(49.181 6)" fill="none" stroke="#a5a4bf" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_5" data-name="5" transform="translate(62.181 24)" fill="#a5a4bf" stroke="rgba(0,0,0,0)" stroke-miterlimit="10" stroke-width="1" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">5</tspan></text>
                </g>
                <g id="step3-4" data-name="step3" transform="translate(168.603 -6)">
                    <g id="Ellipse-4" data-name="Ellipse" transform="translate(6.397 6)" fill="none" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_2" data-name="2" transform="translate(19.397 24)" fill="#116cdd" stroke="rgba(0,0,0,0)" stroke-miterlimit="10" stroke-width="1" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">2</tspan></text>
                </g>
                <g id="step3-5" data-name="step3" transform="translate(43.001 -6)">
                    <g id="Ellipse-5" data-name="Ellipse" transform="translate(5.999 6)" fill="none" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_1" data-name="1" transform="translate(18.999 24)" fill="#116cdd" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">1</tspan></text>
                </g>
                <g id="step4" transform="translate(673 -6)">
                    <g id="Ellipse-6" data-name="Ellipse" transform="translate(6 6)" fill="none" stroke="#a5a4bf" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                    </g>
                    <text id="_6" data-name="6" transform="translate(19 24)" fill="#a5a4bf" stroke="rgba(0,0,0,0)" stroke-miterlimit="10" stroke-width="1" font-size="16" font-family="SourceSansPro-Bold, Source Sans Pro" font-weight="700"><tspan x="-4.256" y="0">6</tspan></text>
                </g>
                <rect id="Rectangle_1763" data-name="Rectangle 1763" width="100" height="2" transform="translate(75 12)" fill="#116cdd"/>
                <rect id="Rectangle_1767" data-name="Rectangle 1767" width="49" height="2" transform="translate(0 12)" fill="url(#linear-gradient)"/>
                <rect id="Rectangle_1765" data-name="Rectangle 1765" width="100" height="2" transform="translate(327 12)" fill="#116cdd"/>
                <rect id="Rectangle_2042" data-name="Rectangle 2042" width="100" height="2" transform="translate(201 12)" fill="#116cdd"/>
                <rect id="Rectangle_1766" data-name="Rectangle 1766" width="100" height="2" transform="translate(453 12)" fill="#a5a4bf" opacity="0.5"/>
                <rect id="Rectangle_2043" data-name="Rectangle 2043" width="100" height="2" transform="translate(579 12)" fill="#a5a4bf" opacity="0.5"/>
                </g>
                <g id="progress-completed" transform="translate(719 106)">
                <g id="Ellipse-7" data-name="Ellipse" fill="#f0f0f7" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                </g>
                <path id="Path_294" data-name="Path 294" d="M1187.471,717.879l4.9,4.833,8.407-8.4" transform="translate(-1181 -705)" fill="none" stroke="#116cdd" stroke-width="2"/>
                </g>
                <g id="progress-completed-2" data-name="progress-completed" transform="translate(845 106)">
                <g id="Ellipse-8" data-name="Ellipse" fill="#f0f0f7" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                </g>
                <path id="Path_294-2" data-name="Path 294" d="M1187.471,717.879l4.9,4.833,8.407-8.4" transform="translate(-1181 -705)" fill="none" stroke="#116cdd" stroke-width="2"/>
                </g>
                <g id="progress-completed-3" data-name="progress-completed" transform="translate(971 106)">
                <g id="Ellipse-9" data-name="Ellipse" fill="#f0f0f7" stroke="#116cdd" stroke-width="2">
                    <circle cx="13" cy="13" r="13" stroke="none"/>
                    <circle cx="13" cy="13" r="12" fill="none"/>
                </g>
                <path id="Path_294-3" data-name="Path 294" d="M1187.471,717.879l4.9,4.833,8.407-8.4" transform="translate(-1181 -705)" fill="none" stroke="#116cdd" stroke-width="2"/>
                </g>
            </g>
            </svg>

    </div>
    <div class="telaestrutura">
        <div class="painelPrincipal">
            <div class="cardconteudo">
                <form id="frmvaga" action="<?php echo site_url('vaga/dadosdavaga') ?>" method="POST">
                    <input id="idvaga" name="idvaga" type="hidden" value="<?php echo $obj->idvaga; ?>">
                    <input id="idcliente" name="idcliente" type="hidden" value="<?php echo $obj->idcliente; ?>">
                    <input id="fasecadastro" name="fasecadastro" type="hidden" value="5">                    
                    <div id="dadosform" class="corpoconteudo">
                        <div class="texto">
                            <h2>Setores target para incluir na busca</h2>                
                            <h4 class="mb-40">
                                Selecione setores que os profissionais ideais já trabalharam.

                                <div class="info">
                                    <i class="fa fa-info-circle"></i>
                                    <span>
                                        Você deve selecionar os setores que serão incluidos na pesquisa de candidatos.
                                        <ins></ins>
                                    </span>
                                </div>
                            </h4>
                            <ul id="areasetores">
                            </ul>
                            <div class="CarregarMais">
                                <button type="button" id="btn-CarregarMais" onclick="CarregarMais(this);" data-posicao="0" data-total="0">
                                    <?php echo __("Carregar mais"); ?>
                                </button>
                            </div>                            
                        </div>
                    </div>
                </form>
            </div>
            <div id="dadosformrodape" class="rodapeconteudo">
                <div class="area-btn">
                    <a href="javascript:;" class="btn-Voltar" onclick="Voltar()">Voltar</a>
                    <a href="javascript:;" class="btn-Avancar" onclick="SalvarVaga()">Salvar e Avançar</a>
                </div>
            </div>
        </div>
        <div class="textoAjuda cardEstrutura">
            <h2>De quais setores da economia o candidato deve vir?</h2>
            <p><b>Dica:</b> quanto mais setores selecionar, mais amplo ficará a busca e o potencial de quantidade de candidatos que iremos apresentar. Porém, recomendamos que selecionem apenas os setores com maior aderência ao negócio. Assim, garantimos qualidade e assertividade do nosso algoritmo.</p>
            <p>Em caso de dúvidas no preenchimento deste formulário você pode nos contatar no <a href="mailto:ajuda@candidatoagora.com.br">ajuda@candidatoagora.com.br</a>. <br/>Retornaremos o contato em breve.</p>
        </div>
    </div>
</section>
<div id="OcultarSetor" style="display: none;">
<!--
<li id="LI{idsetor}" class="terco">
    <input id="idsetortarget{idsetor}" name="idsetortarget[{idsetor}]" type="hidden" value="{idsetortarget}">
    <input id="idsetor{idsetor}" name="idsetor[]" {checked} type="checkbox" value="{idsetor}" data-limpo="0" onchange="DeleteSetorTarget(this, {idsetortarget})">
    <span>
        {setor}
    </span>
</li>
-->
</div>
<script>
    var templatesetor = null;
    function GetTemplateSetor()
    {    
		if(Vazio(templatesetor))
        {
            templatesetor = $("#OcultarSetor").html();
        }
        return templatesetor;
    }
    function AdicionarSetor(setor = null)
    {
        let obj = $("#areasetores");        
		if(Vazio(setor))
        {
            return;
        }
        let caixa = GetTemplateSetor();
        caixa = caixa.replaceAll("<!--", "");
		caixa = caixa.replaceAll("-->", "");
		caixa = caixa.replaceAll("{idsetortarget}", setor.idsetortarget);
        caixa = caixa.replaceAll("{idsetor}", setor.idsetor);
        caixa = caixa.replaceAll("{setor}", setor.setor);
        caixa = caixa.replaceAll("{checked}", setor.checked);
        obj.append(caixa);
    }
    function CarregarMais(obj)
    {
        let url = GetUrlAcao("api","carregarmaissetores");
        let data = null;
        data = {
            "posicao":$(obj).data("posicao"),
            "total":$(obj).data("total"),
            "idvaga":$("#idvaga").val(),
        }    
        $.ajax({
            url: url,
            method:'POST',
            data:data,
            success:function(data){
                if(data.sucesso)
                {
                    if(!Vazio(data.lista))
                    {
                        for( let i = 0; i < data.lista.length; i++)
                        {
                            AdicionarSetor(data.lista[i])
                        }
                    }
                    if(data.finalizar)
                    {
                        $(".CarregarMais").slideUp( "slow" );
                    }
                    else
                    {
                        $(".CarregarMais").css('display','block');
                    }
                    $(obj).data("posicao", data.posicao);
                    $(obj).data("total", data.total);
                }
                else
                {
                    msn = data.erro;
                    titulo = data.titulo;
                    MsnDanger(titulo, msn);
                }
            },
            error: function(XHR, textStatus, errorThrown){
                msn = "Falha ao buscar lista de cidade.";
                MsnDanger("Erro", msn);
            }
        });
    }
    function DeleteSetorTarget(obj, idsetortarget)
    {
        let url = GetUrlAcao("api","deletesetortarget");
        let data = null;
        let limpo = $(obj).data("limpo");
        if(obj.checked)
        {
            return;
        }
        if(Vazio(idsetortarget))
        {
            return;
        }
        if(limpo == "1")
        {            
            return;
        }
        data = {
            "idsetortarget":idsetortarget
        }    
        $.ajax({
            url: url,
            method:'POST',
            data:data,
            success:function(data){
                if(data.sucesso)
                {
                    $(obj).data("limpo","1");
                    msn = data.mensagem;
                    titulo = data.titulo;
                    MsnSucesso(titulo, msn);
                }
                else
                {
                    msn = data.erro;
                    titulo = data.titulo;
                    MsnDanger(titulo, msn);
                }
            },
            error: function(XHR, textStatus, errorThrown){
                msn = "Falha ao buscar lista de cidade.";
                MsnDanger("Erro", msn);
            }
        });
    }
    $(function() {
        CarregarMais($("#btn-CarregarMais").get(0));
        SetabloquearCopia();
    });
</script>

